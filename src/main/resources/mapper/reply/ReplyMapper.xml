<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="org.spring.springsecuritydemo.mapper.reply.ReplyMapper">
    <select id="getReplyList" resultType="reply">
        SELECT a.id, a.notice_id AS noticeId, a.account_id AS accountId, a.content, a.created_at AS createdAt, a.updated_at AS updatedAt, b.username
        FROM reply a
        INNER JOIN account b
        ON a.account_id = b.id
        WHERE a.notice_id = #{id}
        LIMIT #{cri.skip}, #{cri.amount}
    </select>

    <select id="getReply" resultType="reply">
        SELECT a.id, a.notice_id AS noticeId, a.account_id AS accountId, a.content, a.created_at AS createdAt, a.updated_at AS updatedAt, b.username
        FROM reply a
        INNER JOIN account b
        on a.account_id = b.id
        WHERE a.id = #{id}
    </select>

    <insert id="registerReply">
        INSERT INTO reply ( content, notice_id, account_id ) VALUES ( #{content}, #{noticeId}, #{accountId} )
    </insert>

    <update id="updateReply">
        UPDATE reply SET
            content = #{content}
        WHERE id = #{id}
    </update>

    <delete id="deleteReply">
        DELETE FROM reply
        WHERE id = #{id}
    </delete>

    <select id="getReplyTotal" resultType="int">
        SELECT COUNT(*) FROM reply WHERE notice_id = #{id}
    </select>
</mapper>